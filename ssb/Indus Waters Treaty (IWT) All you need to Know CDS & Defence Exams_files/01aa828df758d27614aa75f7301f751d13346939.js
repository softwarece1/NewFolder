(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[18],{"7UE0":function(e,t,a){"use strict";(function(e){var r=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.onUpdateUserPhone=t.onUserVerificationViaPhone=t.onEmailSubmitRequest=t.onLoginViaTruecaller=t.getRequestIdForTruecaller=t.authWithFacebookFinalSuccess=t.onForgotPasswordSubmit=t.onLoginViaOtpSubmit=t.authWithFacebookSuccess=t.onPhoneSubmit=t.onRegisterSubmit=t.onLoginSubmit=t.authWithGoogleFailure=t.authWithGoogleSuccess=void 0;var n=r(a("lSNA")),o=r(a("o0o1")),s=r(a("yXPU")),u=a("M0G7"),i=a("WDcK"),c=a("JwD8");function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(a,!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var f=function(e){var t;if("ERR_EXISTING_GOOGLE_USER"===e.code){var a=e.payload||{};(0,i.fireCustomEvent)({event:"auth-box-state",data:{user:{name:a.username,email:a.email,picture:a.userpic},state:6}})}else if("ERR_EXISTING_FACEBOOK_USER"===e.code){var r=e.payload||{};(0,i.fireCustomEvent)({event:"auth-box-state",data:{user:{name:r.username,email:r.email,picture:r.userpic},state:7}})}else if("ERR_EXISTING_PHONE_USER"===e.code){var n=e.payload||{};(0,i.fireCustomEvent)({event:"auth-box-state",data:{user:{name:n.username,email:n.email,picture:n.userpic},state:9}})}else t=e.reason||e.message;return t},v=function(){return(0,i.fireCustomEvent)({event:"auth-terminated-or-complete"})},p=function(){var e=(0,s.default)(o.default.mark((function e(t){var a,r,n,s,c,l;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.token,r=t.email,n=void 0===r?"":r,s=t.baseUrl,!a){e.next=13;break}return e.prev=2,e.next=5,(0,u.authWithGoogle)({baseUrl:s,body:{email:n,token:a}});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),l=f(e.t0);case 11:c&&(0,i.fireCustomEvent)({event:"auth-user-after-onboard",data:{userData:c,source:"google"}}),l&&(0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:l}});case 13:v();case 14:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();t.authWithGoogleSuccess=p;t.authWithGoogleFailure=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.error,r="";"idpiframe_initialization_failed"===a&&(r=e.outerWidth<1e3?"You have blocked third-party cookies. To enable google login:<br>Goto browser settings > Site settings > Cookies > Uncheck the Block third-party cookies option > Refresh the page":"You have blocked third-party cookies. To enable google login:<br>Goto browser settings > Advanced > Content Settings > Cookies ><br>Toggle off the Block third-party cookies option > Refresh the page"),r="Unable to login/register with Google","popup_closed_by_user"!==a&&"idpiframe_initialization_failed"!==a||(r=""),r&&(0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:r}}),v()};var h=function(){var e=(0,s.default)(o.default.mark((function e(t){var a,r,n,s;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.baseUrl,r=t.body,s="",e.prev=2,e.next=5,(0,u.loginWithEmail)({baseUrl:a,body:r});case 5:n=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),s=f(e.t0);case 11:n&&((0,c.credStore)(r),(0,i.fireCustomEvent)({event:"auth-user-after-onboard",data:{userData:n,source:"login"}})),s&&(0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:s}}),v();case 14:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();t.onLoginSubmit=h;var b=function(){var e=(0,s.default)(o.default.mark((function e(t){var a,r,n,s;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.baseUrl,r=t.body,s="",e.prev=2,e.next=5,(0,u.registerWithEmail)({baseUrl:a,body:r});case 5:n=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),s=f(e.t0);case 11:n&&((0,c.credStore)(r),(0,i.fireCustomEvent)({event:"auth-user-after-onboard",data:{userData:n,source:"register"}})),s&&(0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:s}}),v();case 14:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();t.onRegisterSubmit=b;var m=function(){var e=(0,s.default)(o.default.mark((function e(t){var a,r,n,s;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.baseUrl,r=t.body,s="",e.prev=2,e.next=5,(0,u.sendOtp)({baseUrl:a,body:r});case 5:n=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),s=f(e.t0);case 11:n&&(0,i.fireCustomEvent)({event:"auth-box-state",data:{user:{phone:r.tel.replace(/^\+91/,"")},state:4}}),s&&(0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:s}}),v();case 14:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();t.onPhoneSubmit=m;var g=function(){var e=(0,s.default)(o.default.mark((function e(t){var a,r,n,s,c,l;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.accessToken,r=t.grantedEmailScope,n=t.baseUrl,s=t.preferredEmail,!a){e.next=13;break}return e.prev=2,e.next=5,(0,u.authWithFacebook)({body:{token:a,grantedEmailScope:r,preferredEmail:s},baseUrl:n});case 5:c=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),l=f(e.t0);case 11:c&&(0,i.fireCustomEvent)({event:"auth-user-after-onboard",data:{userData:c,source:"fb"}}),l&&(0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:l}});case 13:v();case 14:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();t.authWithFacebookFinalSuccess=g;var E=function(){var e=(0,s.default)(o.default.mark((function e(t){var a,r,n,s,c,l,d,p,h,b;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.baseUrl,r=t.data,s=(n=r||{}).grantedScopes,c=n.accessToken,l=n.error,d=(l||{}).message,p=void 0===d?"Unable to login with Facebook":d,h=!!s&&-1!==s.indexOf("email"),!l){e.next=7;break}return(0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:p}}),e.abrupt("return");case 7:if(!c){e.next=22;break}return e.prev=8,e.next=11,(0,u.authWithFacebookOptions)({body:{token:c,grantedEmailScope:h,deviceType:"web"},baseUrl:a});case 11:if(!((b=e.sent)&&b.emailIds&&b.emailIds.length>1)){e.next=15;break}return(0,i.fireCustomEvent)({event:"auth-box-state",data:{user:{emails:b.emailIds,accessToken:c,grantedEmailScope:h},state:8}}),e.abrupt("return");case 15:b.userid?(0,i.fireCustomEvent)({event:"auth-user-after-onboard",data:{userData:b,source:"fb"}}):(0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:"Some error occured!"}}),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(8),p=f(e.t0),(0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:p}});case 22:v();case 23:case"end":return e.stop()}}),e,null,[[8,18]])})));return function(t){return e.apply(this,arguments)}}();t.authWithFacebookSuccess=E;var y=function(){var e=(0,s.default)(o.default.mark((function e(t){var a,r,n,s;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.baseUrl,r=t.body,s="",e.prev=2,e.next=5,(0,u.loginViaOtp)({baseUrl:a,body:r});case 5:n=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),s=e.t0.reason||e.t0.message||"Unable to login or verify otp";case 11:n&&n.authResponse&&(n.authResponse.userFound?(0,i.fireCustomEvent)({event:"auth-user-after-onboard",data:{userData:n,source:"otp"}}):(0,i.fireCustomEvent)({event:"auth-box-state",data:{user:d({},n.authResponse,{source:"otp"}),state:5}})),s&&(0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:s}}),v();case 14:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();t.onLoginViaOtpSubmit=y;var k=function(){var e=(0,s.default)(o.default.mark((function e(t){var a,r,n,s;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.baseUrl,r=t.body,s="",e.prev=2,e.next=5,(0,u.forgotPassword)({body:r,baseUrl:a});case 5:n=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),s=e.t0.reason||e.t0.message||"Unable to send reset link";case 11:n&&((0,i.fireCustomEvent)({event:"forgot-password-modal",data:{email:r.email}}),(0,i.fireCustomEvent)({event:"auth-box-state",data:{state:-1}})),s&&(0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:s}}),v();case 14:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();t.onForgotPasswordSubmit=k;var x=function(){var e=(0,s.default)(o.default.mark((function e(t){var a,r,n,s;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.baseUrl,r=t.onCallback,s="",e.prev=2,e.next=5,(0,u.getRequestId)({baseUrl:a});case 5:n=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),s=e.t0.reason||e.t0.message||"Unable to generate truecaller request id";case 11:r({response:n,message:s});case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();t.getRequestIdForTruecaller=x;var w=function(){var e=(0,s.default)(o.default.mark((function e(t){var a,r,n,s;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.baseUrl,r=t.body,s="",e.prev=2,e.next=5,(0,u.loginViaTrueCaller)({baseUrl:a,body:r});case 5:n=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),s=e.t0.reason||e.t0.message||"Unable to login or verify via truecaller";case 11:n&&n.authResponse&&(n.authResponse.userFound?(0,i.fireCustomEvent)({event:"auth-user-after-onboard",data:{userData:n,source:"truecaller"}}):(0,i.fireCustomEvent)({event:"auth-box-state",data:{user:d({},r,{phone:r.phone.replace(/^\+91/,"")},n.authResponse,{source:"truecaller"}),state:5}})),s&&(0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:s}}),v();case 14:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();t.onLoginViaTruecaller=w;var C=function(){var e=(0,s.default)(o.default.mark((function e(t){var a,r,n,s,i;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.baseUrl,r=t.body,n=t.onCallback,i="",e.prev=2,e.next=5,(0,u.submitEmailRequest)({baseUrl:a,body:r});case 5:s=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),i=e.t0.reason||e.t0.message||"Unable to send verification email";case 11:n({response:s,message:i});case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();t.onEmailSubmitRequest=C;var U=function(){var e=(0,s.default)(o.default.mark((function e(t){var a,r,n,s,c,l;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.baseUrl,r=t.body,s="",e.prev=2,e.next=5,(0,u.verifyUserViaPhone)({baseUrl:a,body:r});case 5:n=e.sent,e.next=20;break;case 8:if(e.prev=8,e.t0=e.catch(2),"ERR_EXISTING_USER_FOUND"!==e.t0.code){e.next=14;break}return c=e.t0.payload||{},(0,i.fireCustomEvent)({event:"auth-box-state",data:{user:{existingEmail:c.email,existingPhone:c.phone,interimAuthToken:c.interimAuthToken,switchAllowed:c.switchAllowed},state:10}}),e.abrupt("return");case 14:if("ERR_INVALID_CREDENTIALS"!==e.t0.code){e.next=19;break}return(0,i.fireCustomEvent)({event:"auth-box-state",data:{state:4}}),(0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:e.t0.reason}}),v(),e.abrupt("return");case 19:s=e.t0.reason||e.t0.message||"Unable to verify otp";case 20:n&&((0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:"Verified Successfully"}}),(0,i.fireCustomEvent)({event:"user-phone-verified",data:{phone:r.phone||r.tel}}),l=1),s&&(l=0,(0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:s}})),(0,i.fireCustomEvent)({event:"phone-verification-status",data:{status:l}}),(0,i.fireCustomEvent)({event:"auth-box-state",data:{state:-1}}),v();case 25:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();t.onUserVerificationViaPhone=U;var S=function(){var e=(0,s.default)(o.default.mark((function e(t){var a,r,n,s,c;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.baseUrl,r=t.body,s="",e.prev=2,e.next=5,(0,u.updateUserPhone)({baseUrl:a,body:r});case 5:n=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),s=e.t0.reason||e.t0.message||"Unable to update phone";case 11:n&&((0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:"Verified Successfully"}}),(0,i.fireCustomEvent)({event:"user-phone-verified",data:{phone:r.phone||r.tel}}),c=1),s&&((0,i.fireCustomEvent)({event:"dispatch-toast",data:{content:s}}),c=0),(0,i.fireCustomEvent)({event:"phone-verification-status",data:{status:c}}),(0,i.fireCustomEvent)({event:"auth-box-state",data:{state:-1}}),v();case 16:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}();t.onUpdateUserPhone=S}).call(this,a("yLpj"))},JwD8:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.credStore=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(!window.PasswordCredential||!navigator.credentials)return console.log({err:"PasswordCredential or navigator.credentials is not supported!"}),Promise.resolve();e.id=e.id||e.email;var t=new PasswordCredential(e);navigator.credentials.store(t)}catch(e){console.log({error:e})}return Promise.resolve()},t.credGet=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{mediation:"silent",password:!0};try{return navigator.credentials?navigator.credentials.get(e):Promise.reject({error:"navigator.credentials is undefined!"})}catch(e){return Promise.reject({error:e})}},t.preventSilentAccess=function(){try{navigator.credentials&&navigator.credentials.preventSilentAccess()}catch(e){console.log(e)}return Promise.resolve()}}}]);
//# sourceMappingURL=01aa828df758d27614aa75f7301f751d13346939.03f28167ca9a641ddf9f.js.map